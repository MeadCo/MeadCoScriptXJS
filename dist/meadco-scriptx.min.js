!function(topLevelNs){"use strict";void 0===topLevelNs.ScriptX&&(console.log("intialising new ScriptX package"),topLevelNs.ScriptX={});var scriptx=topLevelNs.ScriptX;scriptx.Connection={NONE:0,ADDON:1,SERVICE:2},scriptx.MeasurementUnits={MM:1,INCHES:2},scriptx.LibVersion="1.8.0",scriptx.Connector=scriptx.Connection.NONE,scriptx.Factory=null,scriptx.Printing=null,scriptx.Utils=null,console.log("Initialising MeadCo.ScriptX: "+scriptx.LibVersion),scriptx.Init=function(){return null===scriptx.Printing&&(console.log("scriptx.Init()"),findFactory()?"function"==typeof scriptx.Printing.PolyfillInit?(console.log("found ScriptX.Print Services"),console.warn("Synchronous initialisation is deprecated - please update to MeadCo.ScriptX.InitAsync()."),scriptx.Printing.PolyfillInit()?scriptx.Connector=scriptx.Connection.SERVICE:(console.log("**warning** polyfill failed."),scriptx.Printing=null,scriptx.Connector=scriptx.Connection.NONE)):scriptx.Connector=scriptx.Connection.ADDON:console.log("** Warning -- no factory **")),null!==scriptx.Printing},scriptx.InitAsync=function(){var n;return console.log("scriptx.InitAsync()"),n=null===scriptx.Printing?(console.log("unknown state ..."),new Promise(function(n,t){console.log("looking for state ..."),findFactory()?(console.log("look for Polyfill .."),"function"==typeof scriptx.Printing.PolyfillInitAsync?(console.log("found async ScriptX.Print Services"),scriptx.Printing.PolyfillInitAsync(function(){scriptx.Connector=scriptx.Connection.SERVICE,n(scriptx.Connector)},t)):(scriptx.Connector=scriptx.Connection.ADDON,console.log("no polyfill, using add-on"),n(scriptx.Connector))):(console.log("** Warning -- no factory **"),t("Unable to find a ScriptX 'factory' object."))})):new Promise(function(n,t){n(scriptx.Connector)}),console.log("scriptx.InitAsync() returns promise"),n},scriptx.InitWithVersion=function(n){var t=!1;return scriptx.Init()&&((t=scriptx.IsVersion(n))||alert("ScriptX v"+n+" or later is required.\nYou are using a previous version and errors may occur.")),t},scriptx.IsVersion=function(n){return scriptx.IsComponentVersion("ScriptX.Factory",n)},scriptx.Version=function(){return scriptx.GetComponentVersion("ScriptX.Factory")},scriptx.IsServices=function(){var n=scriptx.Connector;return n===scriptx.Connection.NONE&&(findFactory()?(n="function"==typeof scriptx.Printing.PolyfillInit?scriptx.Connection.SERVICE:scriptx.Connection.ADDON,scriptx.Printing=null):n=scriptx.Connection.SERVICE),n===scriptx.Connection.SERVICE},scriptx.ServicesVersion=function(){return scriptx.IsServices()?scriptx.GetComponentVersion("scriptx.services"):""},scriptx.IsServicesVersion=function(n){return!!scriptx.IsServices()&&scriptx.IsComponentVersion("scriptx.services",n)},scriptx.PrintPage=function(n){return!!scriptx.Init()&&scriptx.Printing.Print(n)},scriptx.PrintPage2=function(i){return new Promise(function(t,n){scriptx.Init()?scriptx.Connector===scriptx.Connection.SERVICE?scriptx.Printing.Print(i,null,function(n){t(n)}):t(scriptx.Printing.Print(i)):n()})},scriptx.PreviewPage=function(){scriptx.Init()&&scriptx.Printing.Preview()},scriptx.PreviewFrame=function(frame){scriptx.Init()&&scriptx.Printing.Preview("string"==typeof frame?scriptx.IsVersion("6.5.439.30")?frame:eval("window."+frame):frame)},scriptx.PrintFrame=function(frame,bPrompt){return!!scriptx.Init()&&scriptx.Printing.Print(bPrompt,"string"==typeof frame?scriptx.IsVersion("6.5.439.30")?frame:eval("window."+frame):frame)},scriptx.PrintFrame2=function(i,r){return new Promise(function(t,n){scriptx.Init()?scriptx.Connector===scriptx.Connection.SERVICE?scriptx.Printing.Print(r,i,function(n){t(n)}):t(scriptx.PrintFrame(i,r)):n()})};var jobIndex=1;function findFactory(n){var t=window.factory||document.getElementById("factory");return!(!t||void 0===t.object||null===t.object)&&(scriptx.Factory=t,scriptx.Utils=t.object,scriptx.Printing=t.printing,console.log("found a scriptx factory"),!0)}function compareVersions(n,t){var i,r=n.split("."),e=t.split(".");if(r.length!==e.length)return!1;for(i=0;i<r.length;i++)r[i]=parseInt(r[i]),e[i]=parseInt(e[i]);return r[0]>e[0]||(r[0]>=e[0]&&r[1]>e[1]||(r[0]>=e[0]&&r[1]>=e[1]&&r[2]>e[2]||r[0]>=e[0]&&r[1]>=e[1]&&r[2]>=e[2]&&r[3]>=e[3]))}function statusUpdate(n,t){console.log("PrintHTML Queue status: "+n+" => "+t)}function progressMonitor(n,t,i){switch(n){case 1:statusUpdate(n,"Request to print has been queued for: "+i+(void 0===t?"":", "+t));break;case 2:statusUpdate(n,"Print job started on: "+i);break;case 3:statusUpdate(n,"Downloading "+t+" for: "+i);break;case 4:statusUpdate(n,"Download completed to "+t+" for: "+i);break;case 5:statusUpdate(n,"Printing has started for: "+i);break;case 6:statusUpdate(n,"Job complete for: "+i);break;case 7:statusUpdate(n,"Job paused for: "+i);break;case 8:statusUpdate(n,"PDF is being printed: "+t+" for: "+i);break;case-1:statusUpdate(n,"Print failed because of an error: ["+t+"] for: "+i);break;case-2:statusUpdate(n,"Printing has been abandoned for: "+i)}}scriptx.BackgroundPrintURL=function(n,t,i,r){return!!scriptx.Init()&&(void 0===i&&(i=progressMonitor),void 0===r&&(r="Job "+jobIndex++),scriptx.Printing.PrintHTMLEx(n,t,i,r))},scriptx.BackgroundPrintURL2=function(i,r,e,o){return new Promise(function(t,n){scriptx.Init()?(void 0===e&&(e=progressMonitor),void 0===o&&(o="Job "+jobIndex++),scriptx.Connector===scriptx.Connection.SERVICE?scriptx.Printing.PrintHTMLEx(i,r,e,o,function(n){t(n)}):t(scriptx.Printing.PrintHTMLEx(i,r,e,o))):n()})},scriptx.BackgroundPrintHTML=function(n,t,i){return scriptx.BackgroundPrintURL("html://"+n,!1,t,i)},scriptx.DirectPrintString=function(n,t){if(scriptx.Init()){var i=scriptx.Factory.rawPrinting;i.printer=n,i.printString(t)}},scriptx.DirectPrintDocument=function(n,t){if(scriptx.Init()){var i=scriptx.Factory.rawPrinting;i.printer=n,i.printDocument(scriptx.Factory.baseURL(t))}},scriptx.PageSetup=function(){return!!scriptx.Init()&&scriptx.Printing.PageSetup()},scriptx.PrintSetup=function(){return!!scriptx.Init()&&scriptx.Printing.PrintSetup()},scriptx.PageSetup2=function(){return new Promise(function(t,i){scriptx.Init()?scriptx.Connector===scriptx.Connection.SERVICE?scriptx.Printing.PageSetup(function(n){n?t():i()}):scriptx.Printing.PageSetup()?t():i():i()})},scriptx.PrintSetup2=function(){return new Promise(function(t,i){scriptx.Init()?scriptx.Connector===scriptx.Connection.SERVICE?scriptx.Printing.PrintSetup(function(n){n?t():i()}):scriptx.Printing.PrintSetup()?t():i():i()})},scriptx.WaitForSpoolingComplete=function(){return scriptx.Connector===scriptx.Connection.SERVICE?new Promise(function(n,t){scriptx.Printing.WaitForSpoolingComplete(-1,n)}):new Promise(function(n,t){window.setTimeout(function(){scriptx.Printing.WaitForSpoolingComplete(),n()},1)})},scriptx.HasOrientation=function(){return scriptx.IsComponentVersion("ScriptX.Factory","7.0.0.1")},scriptx.GetAvailablePrinters=function(){var n,t=new Array;if(scriptx.Init())try{for(var i=0;0<(n=scriptx.Printing.EnumPrinters(i)).length;i++)t.push(n)}catch(n){}return t},scriptx.GetComponentVersion=function(n){var t=new Object,i=new Object,r=new Object,e=new Object,o="(Not installed)";try{scriptx.Utils.GetComponentVersion(n,t,i,r,e),o=t[0]+"."+i[0]+"."+r[0]+"."+e[0]}catch(n){}return o},scriptx.ScriptXVersion=function(){return scriptx.GetComponentVersion("ScriptX.Factory")},scriptx.SecurityManagerVersion=function(){return scriptx.GetComponentVersion("MeadCo.SecMgr")},scriptx.IsComponentVersion=function(n,t){return compareVersions(scriptx.GetComponentVersion(n),t)}}(window.MeadCo=window.MeadCo||{}),function(n){"use strict";n.Licensing={};var i=n.Licensing;i.Connection={NONE:0,ADDON:1,SERVICE:2},i.LibVersion="1.8.0",i.LicMgr=null,i.Connector=i.Connection.NONE,i.Init=function(){return null===i.LicMgr&&(console.log("licensing.Init()"),o()?"function"==typeof i.LicMgr.PolyfillInit?(console.log("found secmgr services"),console.warn("Synchronous initialisation is deprecated - please update to MeadCo.Licensing.InitAsync()."),i.LicMgr.PolyfillInit()?i.Connector=i.Connection.SERVICE:(console.log("**warning** polyfill failed."),i.LicMgr=null,i.Connector=i.Connection.NONE)):i.Connector=i.Connection.ADDON:console.log("** Warning -- no secmgr **")),null!==i.LicMgr&&void 0!==i.LicMgr.result},i.InitAsync=function(){return console.log("licensing.InitAsync()"),new Promise(function(n,t){null===i.LicMgr?o()?(console.log("Look for polyfill"),"function"==typeof i.LicMgr.PolyfillInitAsync?(console.log("Found async secmgr services"),i.LicMgr.PolyfillInitAsync(function(){console.log("polyfill initialised ok"),i.Connector=i.Connection.SERVICE,n()},t)):(console.log("No polyfill, using as add-on"),i.Connector=i.Connection.ADDON,n())):(console.log("** Warning -- no secmgr **"),t()):i.Connector===i.Connection.NONE?t():n()})},i.IsLicensed=function(){if(i.Init()){i.LicMgr.License;return 0===i.LicMgr.result&&i.LicMgr.validLicense}return console.log("WARNING :: MeadCo.Licensing.Init() failed so IsLicensed will return false."),!1},i.IsLicensedAsync=function(){return new Promise(function(n,t){i.InitAsync().then(function(){"function"==typeof i.LicMgr.GetLicenseAsync?i.LicMgr.GetLicenseAsync(n,t):n(i.LicMgr.License)}).catch(function(){t(e())})})},i.ErrorMessage=function(){return console.log("licensing.ErrorMessage - MeadCo Security Manager reports licensed: "+this.IsLicensed()),i.IsLicensed()?"":e()},i.ReportError=function(n){var t=i.ErrorMessage();""!==t&&function(n){for(var t=n,i=1;i<arguments.length;i++)arguments[i]&&(t+="\n\n"+arguments[i]);alert(t)}(t,n)};var r=new Array("Unable to locate the MeadCo License Manager object - the component may not be installed.","The license for this site is not valid.","The license for this site not installed on this machine.","The license for this site has not been accepted by the user.","There was an error loading the license. ","Unable to connect to ScriptX.Services license management.");function e(){var n=-1,t="";if(null!==i.LicMgr)switch(console.log("license result: "+i.LicMgr.result+" valid: "+i.LicMgr.validLicense),i.LicMgr.result){case 0:i.LicMgr.validLicense||(n=1);break;case 5:n=5;break;case 1:n=2;break;case-2147220500:n=3;break;default:n=4,t="\nLicense manager reported: ("+i.LicMgr.result+")"}else n=0;return 0<=n?r[n]+t:""}function o(){var n=window.secmgr||document.getElementById("secmgr");return!(!n||null===n.object||void 0===n.object)&&(i.LicMgr=n.object,console.log("Found a secmgr: "+(void 0!==i.LicMgr.result)),void 0!==i.LicMgr.result)}}(window.MeadCo=window.MeadCo||{});